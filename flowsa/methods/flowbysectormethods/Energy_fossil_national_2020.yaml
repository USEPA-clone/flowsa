# Method for fossil energy extraction 

industry_spec:
  default: NAICS_6
  NAICS_5: ['2121']
year: &year 2020
target_naics_year: 2017
geoscale: national


source_names:
  EIA_MER:
    # fedefl_mapping: EIA_MER # don't map here but rather map after converting
    # to physical units
    standardize_units: False
    activity_sets:
      fossil:
        selection_fields:
          Description: T01.02
          ActivityProducedBy:
            - Coal Production
            - Crude Oil Production
            - Natural Gas (Dry) Production
            - Natural Gas Plant Liquids Production
        attribute:
          ## multiplication is used here (after EIA_MER invert_heat_content)
          # because it enables the use of attribute_on, a tag not yet available
          # in division.
          - attribution_method: multiplication
            attribution_source:
              EIA_MER:
                clean_fba_w_sec: !script_function:EIA_MER invert_heat_content
                selection_fields:
                  Description:
                    - TA2     # Heat content of Petroleum production, imports, exports
                    - TA4     # Heat content of Natural gas
                    - TA5     # Heat content of Coal and Coal coke
                  ActivityProducedBy:
                    - Coal Production
                    - Crude Oil Production
                    - Natural Gas Production, Dry # Note slight syntax change
                    - Natural Gas Plant Liquids Production
            attribute_on: [Flowable]
          - attribution_method: direct
            clean_fba_after_attribution: !script_function:EIA_MER map_energy_flows
