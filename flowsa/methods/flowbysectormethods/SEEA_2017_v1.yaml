%YAML 1.1

---
# m2 for the GHG national replicates the method used in the National GHG Industry Attribution Model
#(https://doi.org/10.23719/1517571), except that sector attribution is to 6-digit NAICS,
# rather than the BEA 2012 IO schema

# !include:BEA_summary_target.yaml
industry_spec:
  default: NAICS_3
  '336': {default: NAICS_4}
  '541': {default: NAICS_4}
# industry_spec:
#   default: NAICS_4
target_naics_year: 2012
geoscale: national

_ghgi_parameters: &ghgi_parameters
  data_format: 'FBA'
  # class: Chemicals
  geoscale: national
  year: 2017
  fedefl_mapping: 'GHGI'

_attribution_sources:
  BEA_Use_Detail_PRO_BeforeRedef: &bea_use
    activity_to_sector_mapping: BEA_2012_Detail
    year: 2012
    # selection_fields:  # Need to provide
    #   ActivityProducedBy:
    #     - '327400'
    attribution_method: proportional
    attribution_source:
      BLS_QCEW:
        year: 2012
        clean_fba: !script_function:temp_data_source_functions clean_qcew
  USDA_CoA_Cropland_NAICS: &usda_pasture # allocated based on USDA Animal operation land (acres)
    selection_fields:
      Class:
        - Land
      FlowName:
        - FARM OPERATIONS
    year: 2017
    clean_fba: !script_function:temp_data_source_functions clean_usda_cropland_naics
  USDA_CoA_Cropland: &usda_cropland
    selection_fields:
      Class:
        - Land
      FlowName:
        - AREA HARVESTED
        - AREA BEARING & NON-BEARING # Orchards
        - AREA GROWN # Berry totals
        - AREA IN PRODUCTION # Vegetable totals
    year: 2017
    clean_fba: !script_function:USDA_CoA_Cropland coa_irrigated_cropland_fba_cleanup
    clean_fba_w_sec: !script_function:USDA_CoA_Cropland disaggregate_coa_cropland_to_6_digit_naics

source_names:
  # stewiFBS:
  #   data_format: FBS_outside_flowsa
  #   FBS_datapull_fxn: !script_function:stewiFBS stewicombo_to_sector
  #   inventory_dict: {'NEI': '2017'}
  #   local_inventory_name: NEI_TRI_air_2017
  #   selection_fields:  # Remember GHGs should not be drawn from NEI
  #     Flowable:
  #       Particulate matter, ≤ 2.5μm: PM 2.5
  #   compartments:
  #    - air
  #   reassign_process_to_sectors:
  #    - airplane_emissions

## Agriculture
  EPA_GHGI_T_5_29: #CH4, N2O, CO and NOx from field burning of residues
      <<: *ghgi_parameters
      attribution_method: direct
      selection_fields:
        PrimaryActivity:
          - Chickpeas
          - Cotton
          - Maize
          - Rice
          - Soybeans
          - Wheat
  EPA_GHGI_T_5_3: &animals #CH4 from Enteric Fermentation
    <<: *ghgi_parameters
    attribution_method: direct
    selection_fields:
      PrimaryActivity:
        - American Bison
        - Beef Cattle
        - Dairy Cattle
        - Goats
        - Horses
        - Mules and Asses
        - Sheep
        - Swine
        - Poultry
  EPA_GHGI_T_5_7: *animals #CH4 and N2O from manure, mimics enteric fermentation

  EPA_GHGI_T_5_18: #Direct N2O emissions from agricultural soils
    <<: *ghgi_parameters
    activity_sets:
      fertilizer_use: &fertilizer  # allocated based on fertilizer use
        selection_fields:
          PrimaryActivity:
            - Organic Amendment Cropland
            - Residue N Cropland
            - Synthetic Fertilizer Cropland
        attribution_method: proportional
        attribution_source:
          BEA_Use_Detail_PRO_BeforeRedef:
            <<: *bea_use
            selection_fields:
              ActivityProducedBy:
                - '325310'
      cropland:
        selection_fields:
          PrimaryActivity:
            - Mineralization and Asymbiotic Fixation Cropland
            - Drained Organic Soils Cropland
        attribution_method: proportional
        attribution_source:
          USDA_CoA_Cropland:
            <<: *usda_cropland
      pasture: &pasture
        selection_fields:
          PrimaryActivity:
            - All activities Grassland
        attribution_method: proportional
        attribution_source:
          USDA_CoA_Cropland_NAICS:
            <<: *usda_pasture

  "EPA_GHGI_T_5_19": #Indirect N2O emissions from agricultural soils
    <<: *ghgi_parameters
    activity_sets:
      fertilizer_use:  # allocated based on fertilizer use
        <<: *fertilizer
        selection_fields:
          PrimaryActivity:
            - Volatilization & Atm. Deposition Cropland
            - Surface Leaching & Run-Off Cropland
      pasture:
        <<: *pasture
