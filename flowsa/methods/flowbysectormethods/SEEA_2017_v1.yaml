%YAML 1.1

---
# m2 for the GHG national replicates the method used in the National GHG Industry Attribution Model
#(https://doi.org/10.23719/1517571), except that sector attribution is to 6-digit NAICS,
# rather than the BEA 2012 IO schema

# !include:BEA_summary_target.yaml
industry_spec:
  default: NAICS_3
  '336': {default: NAICS_4}
  '541': {default: NAICS_4}
# industry_spec:
#   default: NAICS_4
target_naics_year: 2012
geoscale: national

_ghgi_parameters: &ghgi_parameters
  data_format: FBA
  geoscale: national
  year: 2017
  fedefl_mapping: GHGI

_attribution_sources:
  BEA_Use_Detail_PRO_BeforeRedef: &bea_use
    activity_to_sector_mapping: BEA_2012_Detail
    year: 2012
    # selection_fields:  # Need to provide
    #   ActivityProducedBy:
    #     - '327400'
    attribution_method: proportional
    attribution_source:
      BLS_QCEW:
        selection_fields:
          Class: Employment
        year: 2012
        clean_fba: !script_function:temp_data_source_functions clean_qcew
  USDA_CoA_Cropland_NAICS: &usda_pasture # allocated based on USDA Animal operation land (acres)
    selection_fields:
      Class:
        - Land
      FlowName:
        - FARM OPERATIONS
    year: 2017
    clean_fba: !script_function:temp_data_source_functions clean_usda_cropland_naics
  USDA_CoA_Cropland: &usda_cropland
    selection_fields:
      Class:
        - Land
      FlowName:
        - AREA HARVESTED
        - AREA BEARING & NON-BEARING # Orchards
        - AREA GROWN # Berry totals
        - AREA IN PRODUCTION # Vegetable totals
    year: 2017
    clean_fba: !script_function:USDA_CoA_Cropland coa_irrigated_cropland_fba_cleanup
    clean_fba_w_sec: !script_function:USDA_CoA_Cropland disaggregate_coa_cropland_to_6_digit_naics

source_names:
  # stewiFBS:
  #   data_format: FBS_outside_flowsa
  #   FBS_datapull_fxn: !script_function:stewiFBS stewicombo_to_sector
  #   inventory_dict: {'NEI': '2017'}
  #   local_inventory_name: NEI_TRI_air_2017
  #   selection_fields:  # Remember GHGs should not be drawn from NEI
  #     Flowable:
  #       Particulate matter, ≤ 2.5μm: PM 2.5
  #   compartments:
  #    - air
  #   reassign_process_to_sectors:
  #    - airplane_emissions

  # EPA_GHGI_T_2_1: #U.S. GHG emissions
  #   <<: *ghgi_parameters
  #   activity_sets:
  #     direct_attribution:
  #       selection_fields:
  #         PrimaryActivity:
  #           - Iron and Steel Production & Metallurgical Coke Production #CO2, CH4
  #           - Cement Production #CO2
  #           - Lime Production #CO2
  #           - Ammonia Production #CO2
  #           - Incineration of Waste #CO2, #N2O
  #           - Aluminum Production #CO2
  #           - Soda Ash Production #CO2
  #           - Ferroalloy Production #CO2, CH4
  #           - Titanium Dioxide Production #CO2
  #           - Zinc Production #CO2
  #           - Phosphoric Acid Production #CO2
  #           - Glass Production #CO2
  #           - Carbide Production and Consumption #CO2, CH4
  #           - Landfills #CH4
  #           - Coal Mining #CH4
  #           - Wastewater Treatment #CH4, N2O
  #           - Rice Cultivation #CH4
  #           - Abandoned Oil and Gas Wells #CH4
  #           - Abandoned Underground Coal Mines #CH4
  #           - Anaerobic Digestion at Biogas Facilities #CH4 new activity
  #           - Composting #CH4, N2O
  #           - Nitric Acid Production #N2O
  #           - Adipic Acid Production #N2O
  #           - Caprolactam, Glyoxal, and Glyoxylic Acid Production #CH4
  #           - Electronics Industry #N2O
  #         FlowName: # HFCs and other flows are attributed elsewhere
  #           - CO2
  #           - CH4
  #           - N2O
  #       attribution_method: direct

  #     electric_distribution:
  #       selection_fields:
  #         PrimaryActivity: Electrical Transmission and Distribution #SF6
  #         FlowName: SF6
  #       attribution_method: direct

  #     liming:
  #       selection_fields:
  #         PrimaryActivity: Liming  #CO2
        # attribution_method: proportional
        # attribution_source:
        #   BEA_Use_Detail_PRO_BeforeRedef:
        #     <<: *bea_use
        #     selection_fields:
        #       ActivityProducedBy: '327400'

  #     urea:
  #       selection_fields:
  #         PrimaryActivity:
  #           - Urea Fertilization #CO2
  #           - Urea Consumption for Non-Agricultural Purposes #CO2
  #       attribution_method: proportional
  #       attribution_source:
  #         BEA_Use_Detail_PRO_BeforeRedef:
  #           <<: *bea_use
  #           selection_fields:
  #             ActivityProducedBy: '325310' # Fertilizers

  #     carbonate_use:
  #       selection_fields:
  #         PrimaryActivity: Other Process Uses of Carbonates #CO2
  #       attribution_method: proportional
  #       attribution_source:
  #         BEA_Use_Detail_PRO_BeforeRedef:
  #           <<: *bea_use
  #           selection_fields:
  #             ActivityProducedBy: '325180' # Other Basic Inorganic Chemicals

  #     lead_production:
  #       selection_fields:
  #         PrimaryActivity: Lead Production #CO2
  #       attribution_method: proportional
  #       attribution_source:
  #         USGS_MYB_Lead:
  #           year: 2016
  #           selection_fields:
  #             ActivityProducedBy:
  #               - Primary lead, refined content, domestic ores and base bullion
  #               - Secondary lead, lead content

  #     nitrous_oxide_use:
  #       selection_fields:
  #         PrimaryActivity: N2O from Product Uses #N2O
  #       attribution_method: proportional
  #       attribution_source:
  #         BEA_Use_Detail_PRO_BeforeRedef:
  #           <<: *bea_use
  #           selection_fields:
  #             ActivityProducedBy: '325120' # Industrial gases

# ## Stationary Combustion for Electric Power
#   EPA_GHGI_T_3_7: &stationary_electric # CO2 emissions from stationary combustion (electricity only)
#     <<: *ghgi_parameters
#     selection_fields:
#       PrimaryActivity:
#         - Coal Electric Power
#         - Natural Gas Electric Power
#         - Natural gas Electric Power # note lower case
#         - Fuel Oil Electric Power
#         - Geothermal Electric Power
#         - Wood Electric Power
#     activity_to_sector_mapping: EPA_GHGI_m2
#     attribution_method: direct
#   EPA_GHGI_T_3_8: *stationary_electric # CH4 emissions from stationary combustion
#   EPA_GHGI_T_3_9: *stationary_electric # N2O emissions from stationary combustion

# ## Fossil Fuels
#   EPA_GHGI_T_3_63: &natgas #CH4 from Natural Gas Systems
#     <<: *ghgi_parameters
#     selection_fields:
#       PrimaryActivity:
#         - Distribution
#         - Exploration
#         - Processing
#         - Production
#         - Transmission and Storage
#     attribution_method: direct
#   EPA_GHGI_T_3_65: *natgas #CO2 from Natural Gas Systems mimics CH4
#   EPA_GHGI_T_3_67: *natgas #N2O from Natural Gas Systems, not used in original method, mimics CH4

#   EPA_GHGI_T_3_38: &petroleum #CH4 from Petroleum Systems
#     <<: *ghgi_parameters
#     selection_fields:
#       PrimaryActivity:
#         - Crude Oil Transportation
#         - Exploration
#         - Production
#         - Refining
#     attribution_method: direct
#   EPA_GHGI_T_3_40: *petroleum #CO2 from Petroleum Systems mimics CH4
#   EPA_GHGI_T_3_42: *petroleum #N2O from Petroleum Systems, not in prior method, mimics CH4

# ## Agriculture
#   EPA_GHGI_T_5_29: #CH4, N2O, CO and NOx from field burning of residues
#       <<: *ghgi_parameters
#       attribution_method: direct
#       selection_fields:
#         PrimaryActivity:
#           - Chickpeas
#           - Cotton
#           - Maize
#           - Rice
#           - Soybeans
#           - Wheat

#   EPA_GHGI_T_5_3: &animals #CH4 from Enteric Fermentation
#     <<: *ghgi_parameters
#     attribution_method: direct
#     selection_fields:
#       PrimaryActivity:
#         - American Bison
#         - Beef Cattle
#         - Dairy Cattle
#         - Goats
#         - Horses
#         - Mules and Asses
#         - Sheep
#         - Swine
#         - Poultry
#   EPA_GHGI_T_5_7: *animals #CH4 and N2O from manure, mimics enteric fermentation

#   EPA_GHGI_T_5_18: #Direct N2O emissions from agricultural soils
#     <<: *ghgi_parameters
#     activity_sets:
#       fertilizer_use: &fertilizer  # allocated based on fertilizer use
#         selection_fields:
#           PrimaryActivity:
#             - Organic Amendment Cropland
#             - Residue N Cropland
#             - Synthetic Fertilizer Cropland
#         attribution_method: proportional
#         attribution_source:
#           BEA_Use_Detail_PRO_BeforeRedef:
#             <<: *bea_use
#             selection_fields:
#               ActivityProducedBy:
#                 - '325310'
#       cropland:
#         selection_fields:
#           PrimaryActivity:
#             - Mineralization and Asymbiotic Fixation Cropland
#             - Drained Organic Soils Cropland
#         attribution_method: proportional
#         attribution_source:
#           USDA_CoA_Cropland:
#             <<: *usda_cropland
#       pasture: &pasture
#         selection_fields:
#           PrimaryActivity:
#             - All activities Grassland
#         attribution_method: proportional
#         attribution_source:
#           USDA_CoA_Cropland_NAICS:
#             <<: *usda_pasture
#   EPA_GHGI_T_5_19: #Indirect N2O emissions from agricultural soils
#     <<: *ghgi_parameters
#     activity_sets:
#       fertilizer_use:  # allocated based on fertilizer use
#         <<: *fertilizer
#         selection_fields:
#           PrimaryActivity:
#             - Volatilization & Atm. Deposition Cropland
#             - Surface Leaching & Run-Off Cropland
#       pasture:
#         <<: *pasture

## Mobile Sources (N20 and CH4)
  EPA_GHGI_T_3_14: &mobile #CH4 from mobile combustion
    <<: *ghgi_parameters
    activity_sets:
      direct_attribution: # Some of these need to be separated and attributed differently
        selection_fields:
          PrimaryActivity:
            - Passenger Cars Gasoline On-Road
            # - Light-Duty Trucks Gasoline On-Road
            - Rail Non-Road
            - Ships and Boats Non-Road
            - Aircraft Non-Road
            # - Medium- and Heavy-Duty Trucks and Buses Diesel On-Road
        attribution_method: direct

      trucking:
        selection_fields:
          PrimaryActivity:
            - Light-Duty Trucks Gasoline On-Road
            - Medium- and Heavy-Duty Trucks and Buses Diesel On-Road
        attribution_method: proportional
        attribution_source:
          BTS_TSA

      # construction_and_mining:
      #   selection_fields:
      #     PrimaryActivity: Construction/Mining Equipment Non-Road
      #   attribution_method: proportional
      #   attribution_source:
      #     BEA_Use_Detail_PRO_BeforeRedef:
      #       <<: *bea_use
      #       selection_fields:
      #         ActivityProducedBy: '333120' # purchases of construction/mining equipment

      # farm_non_road:
      #   selection_fields:
      #     PrimaryActivity: Agricultural Equipment Non-Road
      #   attribution_method: proportional
      #   attribution_source:
      #     BEA_Use_Detail_PRO_BeforeRedef:
      #       <<: *bea_use
      #       selection_fields:
      #         ActivityProducedBy: '333111' # purchases of farm machinery

      # other_non_road: # attributed by purchases of petroleum refinery products
      #   selection_fields:
      #     PrimaryActivity: Other Non-Road
      #   attribution_method: proportional
      #   attribution_source:
      #     BEA_Use_Detail_PRO_BeforeRedef:
      #       <<: *bea_use
      #       selection_fields:
      #         ActivityProducedBy: '324110' # purchases of refinery products

      # alt_fuel_on_road: # assumes natural gas is primary alternate fuel
      #   selection_fields:
      #     PrimaryActivity: Alternative Fuel On-Road
      #   attribution_method: proportional
      #   attribution_source:
      #     BEA_Use_Detail_PRO_BeforeRedef:
      #       <<: *bea_use
      #       selection_fields:
      #         ActivityProducedBy: '221200' # purchases of natural gas

  # "EPA_GHGI_T_3_15": *mobile #N2O from mobile combustion duplicates method for CH4
