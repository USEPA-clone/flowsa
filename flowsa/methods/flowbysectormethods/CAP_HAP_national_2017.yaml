
industry_spec:
  default: NAICS_6
year: 2017
target_naics_year: 2012
geoscale: national

sources_to_cache:
  EIA_MECS_Energy:
    year: 2014
    selection_fields:
      Class: Energy
      Unit: Trillion Btu
      Location: '00000'
      Description:
          - Table 2.2
          - Table 3.2
    estimate_suppressed: !script_function:temp_data_source_functions estimate_suppressed_mecs_energy
    clean_fba: !script_function:temp_data_source_functions clean_mecs_energy_fba
    clean_fba_w_sec: !script_function:temp_data_source_functions clean_mapped_mecs_energy_fba
    attribution_method: proportional
    attribution_source:
      Employment_national_2014:
        data_format: FBS
        year: 2014

_attribution_sources:
  BEA: &bea
    year: 2012
    geoscale: national
    activity_to_sector_mapping: BEA_2012_Detail
    attribution_method: proportional
    attribution_source:
      Employment_national_2012:
        data_format: FBS
        year: 2012

  USDA_CoA_Cropland: &cropland_allocation
    year: 2017
    geoscale: state
    selection_fields:
      Class: Land
      FlowName: AREA HARVESTED
    attribution_method: proportional
    attribution_source:
      USDA_CoA_Cropland_NAICS:
        year: 2017
        geoscale: state
        selection_fields:
          Class: Land
          FlowName: AG LAND, CROPLAND, HARVESTED

  USDA_CoA_Livestock: &livestock_allocation
    year: 2017
    geoscale: state
    selection_fields:
        Class: Other
        FlowName:
          - HEAD
          - NUMBER
          - COLONIES
        Compartment: NOT SPECIFIED

source_names:
  EPA_NEI_Nonpoint:
    geoscale: state
    year: 2017
    primary_action_type: Produced
    activity_to_sector_mapping: SCC
    clean_fba_before_activity_sets: !script_function:EPA_NEI clean_NEI_fba
    fedefl_mapping: NEI
    drop_unmapped_rows: True
    activity_sets:
      direct_allocation:
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv direct_allocation
        attribution_method: direct
      
      cropland:
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv cropland
        attribution_method: proportional
        attribution_source: *cropland_allocation

      industry_combustion_coal: #only allocating to 3digits
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv industry_combustion_coal
        attribution_method: proportional
        attribution_source:
          EIA_MECS_Energy:
            selection_fields:
              Flowable: Coal
      
      industry_combustion_coke: #only allocating to 3digits
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv industry_combustion_coke
        attribution_method: proportional
        attribution_source:
          EIA_MECS_Energy:
            selection_fields:
              Flowable: Coke and Breeze
      
      industry_combustion_distillate: #only allocating to 3digits
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv industry_combustion_distillate
        attribution_method: proportional
        attribution_source:
          EIA_MECS_Energy:
            selection_fields:
              Flowable: Distillate Fuel Oil
      
      industry_combustion_hgl: #only allocating to 3digits
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv industry_combustion_hgl
        attribution_method: proportional
        attribution_source:
          EIA_MECS_Energy:
            selection_fields:
              Flowable: Hydrocarbon Gas Liquids, excluding natural gasoline
              
      industry_combustion_nat_gas: #only allocating to 3digits
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv industry_combustion_nat_gas
        attribution_method: proportional
        attribution_source:
          EIA_MECS_Energy:
            selection_fields:
              Flowable: Natural Gas

      industry_combustion_other: #only allocating to 3digits
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv industry_combustion_other
        attribution_method: proportional
        attribution_source:
          EIA_MECS_Energy:
            selection_fields:
              Flowable: Other

      industry_combustion_residual: #only allocating to 3digits
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv industry_combustion_residual
        attribution_method: proportional
        attribution_source:
          EIA_MECS_Energy:
            selection_fields:
              Flowable: Residual Fuel Oil

      livestock: #Livestock losing NAICS 11211
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv livestock
        attribution_method: proportional
        attribution_source: *livestock_allocation

      mobile_and_fuel_storage:
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv mobile_and_fuel_storage
        attribution_method: proportional
        attribution_source:
          BEA_Use_Detail_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'324110': ''}  # Petroleum

      fertilizers:
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv fertilizers
        attribution_method: proportional
        attribution_source:
          BEA_Use_Detail_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'325310': ''}  # Fertilizers

      pesticides: # pesticides
        clean_fba_before_mapping: !script_function:EPA_NEI drop_pesticides
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonpoint_2017_asets.csv pesticides
        attribution_method: proportional
        attribution_source:
          BEA_Use_Detail_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'325320': ''}  # Pesticides

      output_allocation: # Gross Output
        selection_fields:
          PrimaryActivity: NEI_Nonpoint_2017_asets.csv output_allocation
        attribution_method: proportional
        attribution_source:
          BEA_GDP_GrossOutput:
            year: 2017
            activity_to_sector_mapping: BEA_2012_Detail
            selection_fields:
              Class: Money
              FlowName: Gross Output
            attribution_method: proportional
            attribution_source:
              Employment_national_2017:
                data_format: FBS
                year: 2017


  EPA_NEI_Nonroad:
    geoscale: state
    year: 2017
    primary_action_type: Produced
    activity_to_sector_mapping: SCC
    clean_fba_before_activity_sets: !script_function:EPA_NEI clean_NEI_fba
    fedefl_mapping: NEI
    activity_sets:
      direct_allocation:
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonroad_2017_asets.csv direct_allocation
        attribution_method: direct

      offroad_vehicles_equipment:
        selection_fields:
          PrimaryActivity: !from_index:NEI_Nonroad_2017_asets.csv offroad_vehicles_equipment
        attribution_method: proportional
        attribution_source:
          BEA_Use_Detail_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'324110': ''}  # Petroleum

  EPA_NEI_Onroad:
    geoscale: state
    year: 2017
    primary_action_type: Produced
    activity_to_sector_mapping: SCC
    clean_fba_before_activity_sets: !script_function:EPA_NEI clean_NEI_fba
    fedefl_mapping: NEI
    activity_sets:
      direct_allocation:
        selection_fields:
          PrimaryActivity: !from_index:NEI_Onroad_2017_asets.csv direct_allocation
        attribution_method: direct

      onroad_vehicles_gas_stations:
        selection_fields:
          PrimaryActivity: !from_index:NEI_Onroad_2017_asets.csv onroad_vehicles_gas_stations
        attribution_method: proportional
        attribution_source:
          BEA_Use_Detail_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'324110': ''}  # Petroleum

  stewiFBS:
    data_format: FBS_outside_flowsa
    FBS_datapull_fxn: !script_function:stewiFBS stewicombo_to_sector
    inventory_dict: {"NEI":"2017", "TRI":"2017"}
    local_inventory_name: NEI_TRI_air_2017
    clean_fbs: !script_function:EPA_NEI drop_GHGs
    compartments:
     - air
    reassign_process_to_sectors:
     - airplane_emissions
