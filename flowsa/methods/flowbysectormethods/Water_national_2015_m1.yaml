# Attribute USGS NWIS water withdrawal to sectors.

industry_spec:
  default: NAICS_6
year: 2015
target_naics_year: 2012
geoscale: national

source_names:
  "USGS_NWIS_WU":
    fedefl_mapping: USGS_NWIS_WU
    geoscale: state
    clean_fba_before_activity_sets: !script_function:USGS_NWIS_WU usgs_fba_data_cleanup
    clean_fba_w_sec: !script_function:USGS_NWIS_WU usgs_fba_w_sectors_data_cleanup
    activity_sets:
      direct_attribution:
        selection_fields:
          PrimaryActivity:
          - "Aquaculture"
          - "Irrigation Golf Courses"
          - "Public Supply"
          - "Thermoelectric Power"
          - "Domestic"
        attribution_method: direct
      employment_attribution:
        selection_fields:
          PrimaryActivity:
          - "Industrial"
          - "Mining"
        attribution_method: proportional
        attribution_source:
          Employment_national_2015:
            geoscale: national
            data_format: FBS
            year: 2015
      cropland_attribution:
        industry_spec:
          default: NAICS_6
          '111150': { default: NAICS_7 }
          '111199': { default: NAICS_7 }
          '111940': { default: NAICS_7 }
        selection_fields:
          PrimaryActivity:
            - "Irrigation Crop"
        attribution_method: proportional
        attribution_source:
          USDA_CoA_Cropland:
            year: 2017
            activity_sets:
              cropland_attribution-pastureland:
                selection_fields:
                  Class: "Land"
                  FlowName:
                    - "AREA HARVESTED, IRRIGATED"
                    - "AREA IN PRODUCTION, IRRIGATED"
                    - "AREA, IRRIGATED"
                    - 'AREA BEARING & NON-BEARING, IRRIGATED'
                    - 'AREA GROWN, IRRIGATED'
                  PrimaryActivity: 'AG LAND, (EXCL HARVESTED CROPLAND)'
                attribution_method: proportional
                attribution_source:
                  USDA_CoA_Cropland_NAICS:
                    # todo: estimate suppressed data
                    year: 2017
                    selection_fields:
                      Class: Land
                      FlowName:
                        - "FARM OPERATIONS"
                      PrimaryActivity: ["112111", "112112", "11212", "1122",
                                        "11231", "11232", "11233", "11234",
                                        "11239", "11241", "11242", "11291",
                                        "11292", "11293", "11299"]
                    estimate_suppressed: !script_function:temp_data_source_functions estimate_suppressed_sectors_equal_attribution
                    attribution_method: multiplication
                    attribution_source:
                      USDA_IWMS: &usda_iwms
                        year: 2018
                        selection_fields:
                            Class: Water
                        allocation method: proportional
                        allocation_source:
                          USDA_IWMS:
                            year: 2018
                            selection_fields:
                              Class: Land
                              PrimaryActivity: ['HAY & HAYLAGE, (EXCL ALFALFA)', 'HAY & HAYLAGE, ALFALFA']
              cropland_attribution-cropland:
                selection_fields:
                  Class: "Land"
                  FlowName:
                    - "AREA HARVESTED, IRRIGATED"
                    - "AREA IN PRODUCTION, IRRIGATED"
                    - "AREA, IRRIGATED"
                    - 'AREA BEARING & NON-BEARING, IRRIGATED'
                    - 'AREA GROWN, IRRIGATED'
                  PrimaryActivity: ['SOYBEANS', 'CANOLA', 'FLAXSEED',
                                    'MUSTARD, SEED', 'RAPESEED',
                                    'SAFFLOWER', 'SESAME', 'SUNFLOWER',
                                    'CAMELINA', 'BEANS, DRY EDIBLE, (EXCL
                                    LIMA), INCL CHICKPEAS', 'BEANS, DRY
                                    EDIBLE, (EXCL CHICKPEAS & LIMA)',
                    'BEANS, DRY EDIBLE, LIMA', 'CHICKPEAS', 'LENTILS',
                    'PEAS, DRY EDIBLE', 'PEAS, DRY, SOUTHERN (COWPEAS)',
                    'WHEAT', 'CORN', 'CORN, GRAIN', 'CORN, SILAGE',
                    'POPCORN, SHELLED', 'RICE', 'BARLEY', 'BUCKWHEAT',
                    'MILLET, PROSO', 'OATS', 'RYE', 'SORGHUM, GRAIN',
                    'SORGHUM, SILAGE', 'SORGHUM, SYRUP', 'TRITICALE', 'WILD
                    RICE', 'EMMER & SPELT', 'VEGETABLE TOTALS', 'ORCHARDS',
                    'BERRY TOTALS', 'CUT CHRISTMAS TREES', 'SHORT TERM WOODY
                     CROPS', 'TOBACCO', 'COTTON', 'SUGARCANE, SUGAR',
                    'SUGARCANE, SEED', 'HAY & HAYLAGE', 'SUGARBEETS',
                    'SUGARBEETS, SEED', 'PEANUTS', 'DILL, OIL', 'GRASSES &
                    LEGUMES TOTALS, SEED', 'GUAR', 'HERBS, DRY', 'HOPS',
                    'JOJOBA', 'MINT, OIL', 'MISCANTHUS', 'MINT, TEA LEAVES',
                    'SWITCHGRASS', 'FIELD CROPS, OTHER']
                attribution_method: proportional
                attribution_source:
                  USDA_CoA_Cropland_NAICS:
                    # todo: estimate suppressed NAICS
                    year: 2017
                    selection_fields:
                      Class: Land
                      FlowName:
                        - "AG LAND, CROPLAND, HARVESTED"
                      PrimaryActivity: ["11111", "11112", "11113", "11114",
                                        "11115", "11116", "11119", "111211",
                                        "111219", "11131",
                                        "11132", "111331", "111332",
                                        "111333", "111334", "111335",
                                        "111336", "111339", "11141",
                                        "111421", "111422", "11191", "11192",
                                        "11193", "11194", "11199"]
                    estimate_suppressed: !script_function:temp_data_source_functions estimate_suppressed_sectors_equal_attribution
                    attribution_method: multiplication
                    attribution_source:
                      USDA_IWMS:
                        <<: *usda_iwms
      livestock_attribution:
        industry_spec:
          default: NAICS_6
          '112130': { default: NAICS_7 }
          '112320': { default: NAICS_7 }
          '112390': { default: NAICS_7 }
          '112910': { default: NAICS_7 }
          '112920': { default: NAICS_7 }
          '112930': { default: NAICS_7 }
          '112990': { default: NAICS_7 }
        selection_fields:
          PrimaryActivity:
            - "Livestock"
        attribution_method: proportional
        attribution_source:
          USDA_CoA_Livestock:
            year: 2017
            selection_fields:
              Class: Other
              FlowName:
                - "HEAD"
                - "NUMBER"
                - "COLONIES"
              Compartment:
                - "NOT SPECIFIED"
            attribution_method: multiplication
            attribution_source:
              USGS_WU_Coef:
                industry_spec:
                  default: NAICS_6
                year: 2005
                geoscale: national
                attribution_method: direct
