# This is the 2015 target year method for water m2 which builds off the generic
# method in Water_common

industry_spec:
  default: NAICS_6
year: &year 2015
target_naics_year: 2012
geoscale: national

sources_to_cache:
  USDA_IWMS:
    !include:Water_common.yaml:sources_to_cache:USDA_IWMS
    year: 2018

source_names:
  USGS_NWIS_WU:
    !include:Water_common.yaml:source_names:USGS_NWIS_WU
    activity_sets: # do not import all activity sets from the common file because common file contains activity sets for multiple methods
#      direct_attribution:
#        !include:Water_common.yaml:source_names:USGS_NWIS_WU:activity_sets:direct_attribution
      mining_attribution:
#        !include:Water_common.yaml:source_names:USGS_NWIS_WU:activity_sets:mining_attribution
        geoscale: national
        selection_fields:
          PrimaryActivity:
            - "Mining"
        attribution_method: proportional
        attribution_source:
          Blackhurst_IO:
            year: 2002
            geoscale: national
            selection_fields:
              Class: Water
              FlowName: "Water Withdrawals IO Vector"
            attribute:
                # convert to kg/year for 2002
              - attribution_method: multiplication
                attribution_source:
                  BEA_Make_AR:
                    year: 2002
                    selection_fields:
                      Class: Money
                    attribution_method: proportional
                    attribution_source: Employment_national_2002
                # scale to year of USGS data
              - attribution_method: multiplication
                attribution_source: Employment_national_2015
      industrial_attribution:
#        !include:Water_common.yaml:source_names:USGS_NWIS_WU:activity_sets:industrial_attribution
        selection_fields:
          PrimaryActivity:
            - "Industrial"
        attribution_method: proportional
        attribution_source:
          StatCan_IWS_MI:
            year: 2015
            geoscale: national
            selection_fields:
              Class: Water
              FlowName: "Water intake"
              Location: {'124': '00000'} # replace canadian ISO with FIPS
              LocationSystem: {'ISO': 'FIPS_2015'}
            # todo: convert clean fba fxn into this yaml
#            clean_allocation_fba: !script_function:StatCan_IWS_MI convert_statcan_data_to_US_water_use
            attribution_method: division
            attribution_source:
              StatCan_GDP:
                year: 2015
                selection_fields:
                  Class: Money
                  Location: {'124': '00000'} # replace canadian ISO with FIPS
                  LocationSystem: {'ISO': 'FIPS_2015'}
                attribution_method: multiplication
                attribution_source:
                  BEA_GDP_GrossOutput:
                    year: 2015
                    activity_to_sector_mapping: BEA_2012_Detail
                    selection_fields:
                      Class: Money
                    attribution_method: proportional
                    attribution_source:
                      Employment_national_2015:
                        geoscale: national
      cropland_attribution:
        !include:Water_common.yaml:source_names:USGS_NWIS_WU:activity_sets:cropland_attribution
        attribution_method: proportional
        attribution_source:
          USDA_CoA_Cropland:
            !include:Water_common.yaml:source_names:USGS_NWIS_WU:activity_sets:cropland_attribution:attribution_source:USDA_CoA_Cropland
            year: 2017
      livestock_attribution:
        !include:Water_common.yaml:source_names:USGS_NWIS_WU:activity_sets:livestock_attribution
        attribution_method: proportional
        attribution_source:
          USDA_CoA_Livestock:
            !include:Water_common.yaml:source_names:USGS_NWIS_WU:activity_sets:livestock_attribution:attribution_source:USDA_CoA_Livestock
            year: 2017
