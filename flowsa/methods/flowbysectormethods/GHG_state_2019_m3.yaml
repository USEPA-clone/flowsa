


!include:USEEIO_summary_target.yaml
year: &ghg_year 2019
geoscale: state


source_names:
## Directly sourced from State Inventory
  EPA_StateGHGI:
    geoscale: state
    year: *ghg_year
    fedefl_mapping: GHGI
    activity_sets:
      direct:
      # replicates direct attribution from EPA_GHGI_T_2_1, EPA_GHGI_T_4_80,
      # and EPA_GHGI_T_4_96
        selection_fields:
          PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv direct
        attribution_method: direct
      direct_ods:
      # replicates direct attribution from EPA_GHGI_T_4_102.households
        selection_fields:
          PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv direct_ods
        clean_fba_before_mapping: !script_function:EPA_GHGI split_HFCs_by_type
        clean_parameter:
            # Proportions of specific HFCs are assigned based on national total
            flow_fba: EPA_GHGI_T_4_100
        attribution_method: direct
      electricity_transmission: #SF6
      # replicates electricity_transmission from EPA_GHGI_T_2_1
        selection_fields:
          PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv electricity_transmission
        attribution_method: direct
      petrochemicals: #CO2 for selected petrochemicals
      # replicates EPA_GHGI_T_4_46
        selection_fields:
          PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv petrochemicals
        attribution_method: direct
      ag_livestock: #CH4 from Enteric Fermentation, CH4, N2O from manure
      # replicates EPA_GHGI_T_5_3 and EPA_GHGI_T_5_6
        selection_fields:
          PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv ag_livestock
        attribution_method: direct
      ag_burning: #CH4, N2O, CO and NOx from field burning of residue
      # replicates EPA_GHGI_T_5_28
        selection_fields:
          PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv ag_burning
        attribution_method: direct
      hcfc: # HFCs from HCFC-22 production
      # replicates EPA_GHGI_T_4_50
        selection_fields:
          PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv hcfc
        attribution_method: direct

    # direct_ods


  GHG_national_2019: #U.S. GHG emissions
    year: *ghg_year
    fedefl_mapping: GHGI
    data_format: FBS
    geoscale: national
    activity_sets:

      electric_power:
        selection_fields:
          MetaSources: 'EPA_GHGI_T_2_1.electric_power'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv electric_power

      liming:
        selection_fields:
          MetaSources: 'EPA_GHGI_T_2_1.liming'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv liming

      urea:
        selection_fields:
          MetaSources: 'EPA_GHGI_T_2_1.urea'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv urea


      carbonate_use:
        selection_fields:
          MetaSources: 'EPA_GHGI_T_2_1.carbonate_use'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv carbonate_use

      lead:
        selection_fields:
          MetaSources: 'EPA_GHGI_T_2_1.lead'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv lead

      nitrous_oxide_use:
        selection_fields:
          MetaSources: 'EPA_GHGI_T_2_1.nitrous_oxide_use'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv nitrous_oxide_use


      ng_systems:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_68'
            - 'EPA_GHGI_T_3_70'
            - 'EPA_GHGI_T_3_72'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv ng_systems

      pet_systems:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_42'
            - 'EPA_GHGI_T_3_44'
            - 'EPA_GHGI_T_3_46'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv pet_systems

## Agriculture
      n2o_soil_direct:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_5_17.fertilizer_use'
            - 'EPA_GHGI_T_5_17.cropland'
            - 'EPA_GHGI_T_5_17.pasture'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv n2o_soil_direct

      n2o_soil_indirect:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_5_18.fertilizer_use'
            - 'EPA_GHGI_T_5_18.pasture'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv n2o_soil_indirect

## Mobile Sources
      transport_petroleum:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_13.direct_petroleum'
            - 'EPA_GHGI_T_3_13.petroleum_fuels'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv transport_petroleum

      transport_ng:
        selection_fields:
          MetaSources: 'EPA_GHGI_T_3_13.direct_ng'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv transport_ng

      transport_ch4_n2o_diesel:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_14.petroleum_fuels_diesel'
            - 'EPA_GHGI_T_3_14.direct_diesel'
            - 'EPA_GHGI_T_3_15.petroleum_fuels_diesel'
            - 'EPA_GHGI_T_3_15.direct_diesel'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv transport_diesel

      transport_ch4_n2o_gasoline:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_14.petroleum_fuels_gasoline'
            - 'EPA_GHGI_T_3_14.direct_gasoline'
            - 'EPA_GHGI_T_3_15.petroleum_fuels_gasoline'
            - 'EPA_GHGI_T_3_15.direct_gasoline'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv transport_gasoline

      transport_ch4_n2o_nonroad:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_14.direct_non_road' # Ships, boats, rail
            - 'EPA_GHGI_T_3_14.alt_fuel_on_road'
            - 'EPA_GHGI_T_3_15.direct_non_road' # Ships, boats, rail, air
            - 'EPA_GHGI_T_3_15.alt_fuel_on_road'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv transport_nonroad

      transport_ch4_n2o_nonroad_other:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_14.other_non_road'
            - 'EPA_GHGI_T_3_15.other_non_road'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv transport_nonroad_other

      transport_ch4_n2o_nonroad_ag:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_14.farm_non_road'
            - 'EPA_GHGI_T_3_15.farm_non_road'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv transport_nonroad_ag

      transport_ch4_n2o_nonroad_construction:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_14.construction_and_mining'
            - 'EPA_GHGI_T_3_15.construction_and_mining'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv transport_nonroad_construction


## Stationary Combustion
      stationary_residiential:
        selection_fields:
          MetaSources: 'EPA_GHGI_T_A_6.direct_attribution'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv residential_co2

      stationary_coal:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_A_6.non-manufacturing_coal'
            - 'EPA_GHGI_T_A_6.coal_manufacturing'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv use_table_coal

      stationary_natural_gas:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_A_6.non-manufacturing_natural_gas'
            - 'EPA_GHGI_T_A_6.natural_gas_manufacturing'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv use_table_gas

      stationary_petroleum_fuels:
        selection_fields:
          MetaSources: 'EPA_GHGI_T_A_6.petroleum'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv use_table_pet

      stationary_ch4_n2o:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_8.natural_gas_nonmanufacturing'
            - 'EPA_GHGI_T_3_8.fuel_oil'
            - 'EPA_GHGI_T_3_8.coal_nonmanufacturing'
            - 'EPA_GHGI_T_3_8.ng_manufacturing'
            - 'EPA_GHGI_T_3_8.coal_manufacturing'
            - 'EPA_GHGI_T_3_8.fuel_oil'
            - 'EPA_GHGI_T_3_9.natural_gas_nonmanufacturing'
            - 'EPA_GHGI_T_3_9.fuel_oil'
            - 'EPA_GHGI_T_3_9.coal_nonmanufacturing'
            - 'EPA_GHGI_T_3_9.ng_manufacturing'
            - 'EPA_GHGI_T_3_9.coal_manufacturing'
            - 'EPA_GHGI_T_3_9.fuel_oil'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv ind_com_ch4_n2o

      electric_ch4_n2o:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_8.electric_power'
            - 'EPA_GHGI_T_3_9.electric_power'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv electric_ch4_n2o

      industrial_neu:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_3_22.coal'
            - 'EPA_GHGI_T_3_22.petroleum'
            - 'EPA_GHGI_T_3_22.natural_gas'
            - 'EPA_GHGI_T_3_22.transportation_lubricants'
            - 'EPA_GHGI_T_3_22b.coal'
            - 'EPA_GHGI_T_3_22b.petroleum'
            - 'EPA_GHGI_T_3_22b.natural_gas'
            - 'EPA_GHGI_T_3_22b.transportation_lubricants'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv industrial_neu

      ods_substitutes:
        selection_fields:
          MetaSources:
            - 'EPA_GHGI_T_4_102.refrigerants'
            - 'EPA_GHGI_T_4_102.air_conditioning'
            - 'EPA_GHGI_T_4_102.foams'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            clean_fba_before_mapping: !script_function:EPA_GHGI split_HFCs_by_type
            clean_parameter:
                # Proportions of specific HFCs are assigned based on national total
                flow_fba: EPA_GHGI_T_4_100
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv ods_substitutes

      ods_transportation:
        selection_fields:
          MetaSources: 'EPA_GHGI_T_A_97'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            clean_fba_before_mapping: !script_function:EPA_GHGI split_HFCs_by_type
            clean_parameter:
                # Proportions of specific HFCs are assigned based on national total
                flow_fba: EPA_GHGI_T_4_100
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv ods_transportation

      magnesium:
        selection_fields:
          MetaSources: 'EPA_GHGI_T_4_86'
        attribution_method: proportional
        attribute_on: ['Flowable', 'SectorProducedBy']
        fill_columns: Location
        attribution_source:
          EPA_StateGHGI:
            geoscale: state
            fedefl_mapping: GHGI
            selection_fields:
              PrimaryActivity: !from_index:EPA_StateGHGI_asets.csv magnesium
