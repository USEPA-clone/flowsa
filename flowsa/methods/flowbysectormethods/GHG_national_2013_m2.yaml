# This is a 2013 target year specific implementation of GHG_national_m2
# All parameters add year specific data when needed to implement for 2013
# GHGI FBA table names match the 2022 GHGI Report
# MECS year is 2014
# CoA year is 2012

!include:GHG_national_m2_common.yaml
ghgi_year: &ghgi_year 2013
mecs_year: &mecs_year 2014
coa_year: &coa_year 2012

_attribution_sources:
  BEA: &bea # 2012 Make and Use tables
    year: 2012
    activity_to_sector_mapping: BEA_2012_Detail
    exclusion_fields:
      # Drop irrelevant final demand and total sectors
      ActivityConsumedBy: ['F03000', 'F04000', 'F05000', 'F02E00',
                           'F06E00', 'F07E00', 'F10E00',
                           'T001', 'T004', 'T007']
      ActivityProducedBy: ['T007']
    attribution_method: equal

source_names:
  GHG_national_2013_m1: # National Summary model
    !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1
    year: *ghgi_year
    activity_sets: # Update MECS and CoA year for some activity sets
      !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets

      liming:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:liming
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'327400': ''} # Lime

      urea:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:urea
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'325310': ''} # Fertilizers

      urea_fertilizer:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:urea_fertilizer
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'325310': ''} # Fertilizers

      carbonate_use:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:carbonate_use
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'325180': ''} # Other Basic Inorganic Chemicals

      nitrous_oxide_use:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:nitrous_oxide_use
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'325120': ''} # Industrial gases

      fertilizer_use:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:fertilizer_use
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'325310': ''} # Fertilizers

      petroleum_fuels:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:petroleum_fuels
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'324110': ''} # purchases of refinery products

      petroleum_fuels_diesel:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:petroleum_fuels_diesel
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'324110': ''} # purchases of refinery products

      petroleum_fuels_gasoline:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:petroleum_fuels_gasoline
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'324110': ''} # purchases of refinery products

      construction_and_mining:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:construction_and_mining
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'333120': ''} # purchases of construction/mining equipment

      farm_non_road:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:farm_non_road
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'333111': ''} # purchases of farm machinery

      other_non_road:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:other_non_road
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'324110': ''} # purchases of refinery products

      alt_fuel_on_road:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:alt_fuel_on_road
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'221200': ''} # purchases of natural gas

      non_manufacturing_coal:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:non_manufacturing_coal
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'212100': ''} # purchases of coal

      non_manufacturing_natural_gas:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:non_manufacturing_natural_gas
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'221200': ''} # purchases of natural gas

      coal_manufacturing_co2: # Industrial Coal for Manufacturing
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:coal_manufacturing_co2
        attribution_source:
          EIA_MECS_Energy:
            !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:coal_manufacturing_co2:attribution_source:EIA_MECS_Energy
            year: *mecs_year
            attribution_source:
              BEA_Detail_Use_PRO_BeforeRedef:
                <<: *bea
                selection_fields:
                  ActivityProducedBy: {'212100': ''} # purchases of coal

      natural_gas_manufacturing: # Industrial Natural Gas for manufacturing
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:natural_gas_manufacturing
        attribution_source:
          EIA_MECS_Energy:
            !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:natural_gas_manufacturing:attribution_source:EIA_MECS_Energy
            year: *mecs_year
            attribution_source:
              BEA_Detail_Use_PRO_BeforeRedef:
                <<: *bea
                selection_fields:
                  ActivityProducedBy: {'221200': ''} # purchases of natural gas

      petroleum:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:petroleum
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'324110': ''} # purchases of refinery products

      electric_power:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:electric_power
        attribution_source:
          BEA_Detail_Make_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityConsumedBy: {'221100': ''} # Electricity

      fuel_oil:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:fuel_oil
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'324110': ''} # purchases of refinery products

      natural_gas_nonmanufacturing:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:natural_gas_nonmanufacturing
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'221200': ''} # purchases of natural gas

      coal_nonmanufacturing:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:coal_nonmanufacturing
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'212100': ''} # purchases of coal

      coal_manufacturing:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:coal_manufacturing
        attribution_source:
          EIA_MECS_Energy:
            !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:coal_manufacturing:attribution_source:EIA_MECS_Energy
            year: *mecs_year
            attribution_source:
              BEA_Detail_Use_PRO_BeforeRedef:
                <<: *bea
                selection_fields:
                  ActivityProducedBy: {'212100': ''} # purchases of coal

      ng_manufacturing:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:ng_manufacturing
        attribution_source:
          EIA_MECS_Energy:
            !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:ng_manufacturing:attribution_source:EIA_MECS_Energy
            year: *mecs_year
            attribution_source:
              BEA_Detail_Use_PRO_BeforeRedef:
                <<: *bea
                selection_fields:
                  ActivityProducedBy: {'221200': ''} # purchases of natural gas

      petroleum_neu: # consumed petroleum products
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:petroleum_neu
        attribution_source:
          EIA_MECS_Energy:
            !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:petroleum_neu:attribution_source:EIA_MECS_Energy
            year: *mecs_year
            attribution_source:
              BEA_Detail_Use_PRO_BeforeRedef:
                <<: *bea
                selection_fields:
                  ActivityProducedBy: {'324110': ''} # purchases of refinery products

      natural_gas_neu: # consumed nat gas to chemical plants
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:natural_gas_neu
        attribution_source:
          EIA_MECS_Energy:
            !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:natural_gas_neu:attribution_source:EIA_MECS_Energy
            year: *mecs_year
            attribution_source:
              BEA_Detail_Use_PRO_BeforeRedef:
                <<: *bea
                selection_fields:
                  ActivityProducedBy: {'221200': ''} # purchases of natural gas

      transportation_lubricants:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:transportation_lubricants
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'324110': ''} # purchases of refinery products

      refrigerants:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:refrigerants
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'333415': ''} # Air conditioning equipment

      air_conditioning:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:air_conditioning
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy: {'333415': ''} # Air conditioning equipment

      foams:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:foams
        attribution_source:
          BEA_Detail_Use_PRO_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityProducedBy:
                '326140': '' # Polystyrene foam
                '326150': '' # Urethane and other foam

      magnesium:
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:magnesium
        attribution_source:
          BEA_Detail_Make_BeforeRedef:
            <<: *bea
            selection_fields:
              ActivityConsumedBy: {T008: ''}  # Total Output

      cropland: # allocated based on USDA land area harvested
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:cropland
        attribution_source:
          USDA_CoA_Cropland:
            !include:GHG_national_m2_common.yaml:attribution_sources:_cropland_allocation:USDA_CoA_Cropland
            year: *coa_year
            attribution_source:
              USDA_CoA_Cropland_NAICS:
                !include:GHG_national_m2_common.yaml:attribution_sources:_cropland_allocation:USDA_CoA_Cropland:attribution_source:USDA_CoA_Cropland_NAICS
                year: *coa_year

      pasture: # allocated based on USDA Animal operation land (acres)
        !include:GHG_national_m2_common.yaml:source_names:GHG_national_m1:activity_sets:pasture
        attribution_source:
          USDA_CoA_Cropland_NAICS:
            !include:GHG_national_m2_common.yaml:attribution_sources:_animal_land_allocation:USDA_CoA_Cropland_NAICS
            year: *coa_year

  EPA_GHGI_T_2_1: #U.S. GHG emissions
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_2_1
    year: *ghgi_year
    activity_sets:
      !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_2_1:activity_sets
      lead:
        !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_2_1:activity_sets:lead
        attribution_source:
          USGS_MYB_Lead:
            !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_2_1:activity_sets:lead:attribution_source:USGS_MYB_Lead
            year: *ghgi_year

  EPA_GHGI_T_3_68: #CH4 from Natural Gas Systems
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_3_68
    year: *ghgi_year
  EPA_GHGI_T_3_70: #CO2 from Natural Gas Systems mimics CH4
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_3_70
    year: *ghgi_year
  EPA_GHGI_T_3_72: #N2O from Natural Gas Systems, not used in original method, mimics CH4
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_3_72
    year: *ghgi_year

  EPA_GHGI_T_3_42: #CH4 from Petroleum Systems
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_3_42
    year: *ghgi_year
  EPA_GHGI_T_3_44: #CO2 from Petroleum Systems mimics CH4
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_3_44
    year: *ghgi_year
  EPA_GHGI_T_3_46: #N2O from Petroleum Systems, not in prior method, mimics CH4
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_3_46
    year: *ghgi_year

## Agriculture
  EPA_GHGI_T_5_28: #CH4, N2O, CO and NOx from field burning of residues
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_5_28
    year: *ghgi_year
  EPA_GHGI_T_5_3:  #CH4 from Enteric Fermentation
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_5_3
    year: *ghgi_year
  EPA_GHGI_T_5_6: #CH4 and N2O from manure, mimics enteric fermentation
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_5_6
    year: *ghgi_year

## Mobile Sources
  EPA_GHGI_T_3_13: #CO2 from mobile combustion
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_3_13
    year: *ghgi_year
  EPA_GHGI_T_3_14: &mobile #CH4 from mobile combustion
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_3_14
    year: *ghgi_year
  EPA_GHGI_T_3_15: #N2O from mobile combustion duplicates method for CH4
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_3_15
    year: *ghgi_year

## Stationary Combustion
  EPA_GHGI_T_A_12:
    !include:GHG_national_m2_common.yaml:source_names:GHGI_CO2_stationary_combustion
    year: *ghgi_year
  EPA_GHGI_T_3_8: # CH4 emissions from stationary combustion
     !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_3_8
    year: *ghgi_year
  EPA_GHGI_T_3_9: # N2O emissions from stationary combustion
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_3_9
    year: *ghgi_year

## Other sources
  EPA_GHGI_T_4_46: #CO2 for selected petrochemicals
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_4_46
    year: *ghgi_year

  EPA_GHGI_T_3_22b: # Fossil fuel for non-energy uses
    !include:GHG_national_m2_common.yaml:source_names:GHGI_nonenergy_fossil_fuel_emissions
    year: *ghgi_year

## Other Emissions
  EPA_GHGI_T_4_50: # HFCs from HCFC-22 production
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_4_50
    year: *ghgi_year

  EPA_GHGI_T_4_96: # HFCs and other emissions from electronics manufacture
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_4_96
    year: *ghgi_year

  EPA_GHGI_T_4_102: # HFCs and PFCs from ODS Substitutes
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_4_102
    year: *ghgi_year

  EPA_GHGI_T_A_97: # HFCs from Transportation
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_A_97
    year: *ghgi_year

  EPA_GHGI_T_4_80: # PFCs from aluminum production
    !include:GHG_national_m2_common.yaml:source_names:EPA_GHGI_T_4_80
    year: *ghgi_year
